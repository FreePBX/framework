/* jshint node:true, newcap:false */
//let PBX = require("./dist/pbx.js");
let PBX = require("./src/pbx.js");

PBX.connect().then((pbx) => {
	//FreePBX is now ready
	//freepbx.ami == https://github.com/pipobscure/NodeJS-AsteriskManager
	//freepbx.db == https://github.com/mysqljs/mysql#pooling-connections
	//freepbx.config == freepbx.config.get("VALUE FROM ADVANCED SETTINGS")
	//freepbx.kvstore == see examples below:

	console.log("PBX is ready");
	/*
	pbx.kvstore.setConfig('Dashboard','foo',"hello world")
	.then(function(res) {
		return pbx.kvstore.getConfig('Dashboard','foo')
	})
	.then(function(val) {
		console.log(val)
	}).catch(function(err) {
		console.log(err);
	});
	*/
	/*
	pbx.kvstore.getConfig('FreePBX\\modules\\Zulu','servertoken')
	.then(f => {
		console.log(f)
	})
	.catch(e => {
		console.log(e)
	})
	*/

	/*
	pbx.kvstore.setConfig('FreePBX\\modules\\Zulu', 'test1111', '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')
	.then(f => {
		console.log(f)
	})
	.catch(e => {
		console.log(e)
	})
	*/

	pbx.kvstore.setConfig('FreePBX\\modules\\Zulu', 'test', 'value')
	.then(f => {
		return pbx.kvstore.getAllConfig('FreePBX\\modules\\Zulu')
	})
	.then(f => {
		console.log(f)
		return pbx.kvstore.delConfig('FreePBX\\modules\\Zulu', 'test')
	})
	.then(f => {
		console.log(f)
	})
	.catch(e => {
		console.log(e)
	})
});
